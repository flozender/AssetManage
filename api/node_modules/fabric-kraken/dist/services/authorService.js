"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class AuthorService {
    constructor(clientIdentity) {
        this.userId = this.parseId(clientIdentity.getID());
        this.mspId = clientIdentity.getMSPID();
        this.certificate = clientIdentity.getX509Certificate();
    }
    /**
     * Parse the ID string that the client identity generates to find the UserID of the certificate
     * @param rawId
     */
    parseId(rawId) {
        // The id is split with '::/' for some reason during the init
        let segments;
        if (rawId.indexOf('::/') !== -1)
            segments = rawId.split('::/');
        else if (rawId.indexOf(',') !== -1)
            segments = rawId.split(',');
        // First instance of Common Name (CN) is the UserID
        const idSegment = segments[1];
        const id = idSegment.slice(idSegment.indexOf('CN=') + 3);
        return id;
    }
}
exports.default = AuthorService;
//# sourceMappingURL=authorService.js.map